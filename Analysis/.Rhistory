scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf,
group = truck_perf)) +
geom_line() +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = participant:truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = participant)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = participant)) +
scale_colour_ptol() +
theme_bw() +
facet_wrap(~participant) +
theme(strip.text.x = element_blank())
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line() +
scale_colour_ptol() +
theme_bw() +
facet_wrap(~participant) +
theme(strip.text.x = element_blank())
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = participant:truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
#### PLOT: chance of success on y-axis ####
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = participant:truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = Participant:truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_line(aes(group = Participant)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_line() +
scale_colour_ptol() +
theme_bw()
plt_acc
#### PLOT: chance of success on y-axis ####
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_line(aes(group = participant)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_line(aes(group = Participant)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_line(aes(group = Participant,
colour = truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_line(aes(
colour = truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
#### PLOT: chance of success on y-axis ####
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_path(aes(
colour = truck_perf)) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf)) +
scale_colour_ptol() +
theme_bw() +
facet_wrap(~participant) +
theme(strip.text.x = element_blank())
plt_acc
plt_acc <- df_decisions %>%
mutate(Participant = as.factor(participant)) %>%
group_by(Participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf)) +
scale_colour_ptol() +
theme_bw() +
facet_wrap(~Participant) +
theme(strip.text.x = element_blank())
plt_acc
#### PLOT: chance of success on y-axis ####
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf)) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
#### PLOT: chance of success on y-axis ####
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup() %>%
ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf)) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup() %>%
ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf, group = participant)) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
plt_acc <- ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf, group = participant)) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup()
plt_acc <- ggplot(aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf, group = participant)) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
plt_acc <- ggplot(data = plt_acc, aes(delta, mean_acc)) +
geom_path(aes(colour = truck_perf, group = participant)) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
save(plt_acc$data, file = "scratch/data/plt_acc_data")
save(plt_acc[["data"]], file = "scratch/data/plt_acc_data")
plt_acc[["data"]]
plt_acc_data <- plt_acc[["data"]]
save(plt_acc_data, file = "scratch/data/plt_acc_data")
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup()
plt_acc <- ggplot(data = plt_acc, aes(delta, mean_acc)) +
geom_path(aes(group = interaction(participant, truck_perf))) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
#### Fix at some point... doesn't work...
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup()
plt_acc <- ggplot(data = plt_acc, aes(delta, mean_acc, colour = truck_perf)) +
geom_path(aes(group = interaction(participant, truck_perf))) +
scale_colour_ptol() +
theme_bw()
#facet_wrap(~participant) +
#theme(strip.text.x = element_blank())
plt_acc
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup() %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_path(aes(group = interaction(participant, truck_perf))) +
scale_colour_ptol() +
theme_bw()
plt_acc
View(plt_acc)
View(plt_acc[["data"]])
rm(plt_acc_data)
head(plt_acc_2)
plt_acc_2 <- merge(plt_acc$data, max_speed) %>%
rowwise() %>%
mutate(opt_acc = prob_success(delta, spread, max_speed, TRUE),
cen_acc = prob_success(delta, spread, max_speed, FALSE)) %>%
ungroup() %>%
gather(opt_acc:cen_acc,
"strategy",
"accuracy")
plt_acc_2 <- merge(plt_acc$data, max_speed) %>%
rowwise() %>%
mutate(opt_acc = prob_success(delta, spread, max_speed, TRUE),
cen_acc = prob_success(delta, spread, max_speed, FALSE)) %>%
ungroup() %>%
gather(opt_acc:cen_acc,
key = "strategy",
value = "accuracy")
View(plt_acc_2)
head(plt_acc_2)
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy)))
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
colour = "black"))
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy)),
colour = "black")
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = strategy),
colour = "black")
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf))
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup() %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_path(aes(group = interaction(participant, truck_perf)),
alpha = 0.5) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf))
help("geom_line")
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = c(k,f),
colour = truck_perf
))
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = c("twodash",
"dotdash"),
colour = truck_perf
))
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf))
prob_success <- function(delta, beta, max_speed, opt){
# get observations
y <- (round(rbeta(100000, beta, beta)*max_speed)+1) * travel_time + 30
# get prob of success
acc <- sum(y > delta)/length(y)
# check if opt strat or not
if(opt == TRUE && acc < 0.5){
acc <- 0.5
}
# output
return(round(acc, digits = 3))
}
plt_acc_2 <- merge(plt_acc$data, max_speed) %>%
rowwise() %>%
mutate(opt_acc = prob_success(delta, spread, max_speed, TRUE),
cen_acc = prob_success(delta, spread, max_speed, FALSE)) %>%
ungroup() %>%
gather(opt_acc:cen_acc,
key = "strategy",
value = "accuracy")
plt_acc +
geom_line(data = plt_acc_2, aes(delta, accuracy,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf))
View(plt_acc_2)
head(plt_acc_2)
plt_acc_2 <- merge(plt_acc$data, max_speed) %>%
rowwise() %>%
mutate(opt_acc = prob_success(delta, spread, max_speed, TRUE),
cen_acc = prob_success(delta, spread, max_speed, FALSE)) %>%
ungroup() %>%
gather(opt_acc:cen_acc,
key = "strategy",
value = "accuracy") %>%
group_by(delta, truck_perf, strategy) %>%
summarise(mean_acc = mean(accuracy)) %>%
ungroup()
plt_acc +
geom_line(data = plt_acc_2, aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf)) +
scale_linetype_discrete(linetype)
plt_acc +
geom_line(data = plt_acc_2, aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf))
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 3)
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 2)
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1)
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup() %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_path(aes(group = interaction(participant, truck_perf)),
alpha = 0.5,
size = 1) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1)
plt_acc <- df_decisions %>%
#mutate(Participant = as.factor(participant)) %>%
group_by(participant, delta, truck_perf, spread) %>%
summarise(mean_acc = mean(chance)) %>%
ungroup() %>%
ggplot(aes(delta, mean_acc,
colour = truck_perf)) +
geom_path(aes(group = interaction(participant, truck_perf)),
alpha = 0.2,
size = 1) +
scale_colour_ptol() +
theme_bw()
plt_acc
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1)
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1) +
scale_linetype_manual(value = c("twodash", "longdash"))
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1) +
scale_linetype_manual(values = c("twodash", "longdash"))
plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1) +
scale_linetype_manual(values = c("twodash", "longdash")) +
facet_wrap(~truck_perf)
plt_acc <- plt_acc +
geom_line(data = plt_acc_2,
aes(delta, mean_acc,
group = interaction(truck_perf, strategy),
linetype = strategy,
colour = truck_perf),
size = 1) +
scale_linetype_manual(values = c("twodash", "longdash")) +
facet_wrap(~truck_perf)
plt_acc$labels$x <- "Delta (pixels)"
plt_acc$labels$y <- "Average Accuracy"
plt_acc$labels$colour <- "Condition"
plt_acc$labels$linetype <- "Strategy"
plt_acc
